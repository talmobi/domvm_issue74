/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var u=("undefined"==typeof window?{}:window).requestAnimationFrame,x={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},k={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(a){return a instanceof Array},isVal:function(a){a=typeof a;return"string"===a||"number"===a},isObj:function(a){return"object"===typeof a&&null!==a&&!k.isArr(a)},isFunc:function(a){return"function"===typeof a},isProm:function(a){return"object"===typeof a&&k.isFunc(a.then)},isElem:function(a){return a instanceof HTMLElement},execAll:function(a,f,n,c,d,w){var z;a&&(k.isArr(a)?a:[a]).forEach(function(a){z=a.call(null,f,n,c,d,w)});return z},repaint:function(a){},insertArr:function(a,
f,n,c){a.splice.apply(a,[n,c].concat(f))},isEvProp:function(a){return"on"===a.substr(0,2)},isDynProp:function(a,f){switch(a){case "input":case "textarea":case "select":case "option":switch(f){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(a,f){return isNaN(f)||x[a]?f:f+"px"},cmpArr:function(a,f){var n=a.length;if(n!=f.length)return!1;for(;n--;)if(a[n]!==f[n])return!1;return!0},
deepSet:function(a,f,n,c,d,w){f=f.split(".");var z=f.pop();f.forEach(function(c){a[c]||(a[c]={});a=a[c]});if(k.isFunc(a[z]))a[z](n,c,d,w);else a[z]=n},deepGet:function(a,f){var n=f.split(".");do a=a[n.shift()];while(n.length);return a},keyedIdx:function(a,f,n,c,d){for(c=0;c<f.length;c++)if(d=f[c],d.key===a)if(n){if(d.vm&&d.vm.view[0]===n)return c}else return c;return-1},raft:function(a){function f(){n=0;a.apply(c,d)}if(!u)return a;var n,c,d;return function(){c=this;d=arguments;n||(n=u(f))}}};v.utils=
k})(domvm);(function(v){function u(b){for(I.repaint&&m.repaint(b);b=J.shift();)b[0].apply(null,b.slice(1))}function x(b,g){return!1===g?null:null==g&&null!=b?b:m.isVal(g)||m.isObj(g)||m.isArr(g)||m.isFunc(g)?g:null}function k(b,g,l,c,A,e){function t(b,g,e){if(e)b[g]=b[g]||[],b[g].push(e);else for(var l in g)b[l]=b[l]||[],b[l].push(g[l])}function p(b,g,l){A=b;e=g;r.update(l,!1);null!=r.node&&(A.body[e]=r.node);return k(0,!1)}function w(b){return null==b?"":b}function k(b,a){a=!1!==a;if(b){for(var c=r;b--&&c.parent;)c=
c.parent;c.redraw(0,!0);return c.vm}(c=r.node)&&f(r,"willRedraw",r);var E=r.refs;r.refs={};r.body=[];var h=r.render.call(r.api,r,g,l),t;if(!1===h||(t=d(h,A,e,r,!0))&&D(c,t))return c.moved=!0,c.wasSame=!0,r.refs=E,r;t.vm=r;r.node=t;E=m.isVal(l)&&"^"===l[0]?l.substr(1):m.isVal(t.ref)&&"^"===t.ref[0]?t.ref.substr(1):null;t.key=null!=l?l:t.key;for(h=A;h;)h.vm&&(r.parent||(r.parent=h.vm,h.vm.body.push(r)),null!==E&&m.deepSet(h.vm.refs,E,t)),h=h.parent;if((E=c)&&(t.type!==c.type||t.tag!==c.tag))var E=null,
p=!0,w=c.el.parentNode;z(t,E);A&&(A.body[e]=t);a&&(c&&n(c),!c&&B||q(t,null,t.el),p&&(w||t.parent.el).insertBefore(t.el,w.childNodes[c.idx]));c&&f(r,"didRedraw",r);a&&c&&J.length&&u(t);return r}var B=!A;m.isArr(b)&&(g=b[1],l=b[2],c=b[3],b=b[0]);l=x(g,l);var r={api:{},node:null,view:[b,l],model:g,opts:c||{},render:null,update:function(b,e){null==b||l===g&&!m.isVal(l)||(g=r.model=b);return!1!==e?k(0):r},on:function(b,g){t(r.events,b,g)},hook:function(b,g){r.hooks=r.hooks||{};t(r.hooks,b,g)},events:{},
hooks:null,redraw:I.debounce?m.raft(k):k,patch:function(b,g){var e=null!=b.el;if(m.isObj(g)){b.props=b.props||{};var l="class"in g?(w(b["class"])+" "+w(g["class"])).trim():b.props["class"],c="style"in g?g.style:b.props.style;e&&(e=Object.create(b.props),e["class"]=l,e.style=c,e={tag:b.tag,el:b.el,ns:b.ns,props:e},h(e,b));b.props["class"]=l;b.props.style=c}else l=b.parent,e=z(d(g,l,b.idx,r),b),l.body[b.idx]=e},emit:function(b){for(var g=Array.prototype.slice.call(arguments),e=r,l;e;){if(l=e.events[b]){g[0]=
l;m.execAll.apply(null,g);break}e=e.parent}},refs:{},parent:null,body:[],mount:function(b,g){var e=null;g&&(b.textContent="",e=b,b=null);q(r.node,e,null,b);u(r.node);return r},attach:function(b){a(r.node,b);return r},unmount:function(){n(r.node)},moveTo:p,updIdx:function(b){e=b}};c&&c.hooks&&r.hook(c.hooks);m.execAll(G,r);r.render=b.call(r.api,r,g,l);return A?p(A,e):k(0)}function a(b,g){b.el=g;g._node=b;for(var l in b.props){var c=b.props[l],A=m.isEvProp(l)?l:"."===l[0]?l.substr(1):null;null!==A&&
(g[A]=c)}if(m.isArr(b.body))for(l=0;l<b.body.length;l++)a(b.body[l],g.childNodes[l])}function f(b,g,l,c,a,e){if(b&&b.hooks&&(b=b.hooks[g]))if("did"==g.substr(0,3))J.push([m.execAll,b,l,c,a,e]);else return m.execAll(b,l,c,a,e)}function n(b,g){var l=b.el&&!b.moved;if(l){var a=f(b.vm,"willUnmount",b.vm),A=f(b,"willRemove",b),e=a||A;b.removed=!0}b.wasSame?b.wasSame=!1:(m.isArr(b.body)&&b.body.forEach(function(b,l){n(b,g||e)}),g||(e?e.then(function(){c(b,l,!0)}):c(b,l)));b.moved=!1}function c(b,g,l){K.push(b);
null!=b.el&&b.el.parentNode&&g&&(b.el.parentNode.removeChild(b.el),b.el=null,f(b.vm,"didUnmount",b.vm),f(b,"didRemove",b),l&&u(b.parent))}function d(b,g,l,c,a){var e=b;b=0<K.length?K.pop():{type:null,key:null,ref:null,idx:null,parent:null,moved:!1,wasSame:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null,data:null,diff:null};b.el=b.key=b.ref=b.data=b.diff=b.vm=b.body=b.props=null;b.raw=b.moved=b.wasSame=b.removed=!1;m.isFunc(e)&&(e=e());
var t=e.length;if(m.isArr(e)&&t){b.type=m.TYPE_ELEM;if(1<t){var h=1;!m.isObj(e[1])||e[1].redraw||m.isElem(e[1])||(b.props=e[1],h=2);b.body=t==h+1?m.isVal(e[h])?e[h]:m.isFunc(e[h])?e[h]():e.slice(h):e.slice(h)}e=e[0];t=M[e];t||(t=["",""],t={tag:(e.match(/^[-\w]+/)||["div"])[0],id:(e.match(/#([-\w]+)/)||t)[1],"class":(e.match(/\.([-\w.]+)/)||t)[1].replace(/\./g," ")},M[e]=t);b.tag=t.tag;if(t.id||t["class"])e=b.props||{},t.id&&null==e.id&&(e.id=t.id),t["class"]&&(b["class"]=t["class"],e["class"]=t["class"]+
(null!=e["class"]?" "+e["class"]:"")),b.props=e;if(b.props){var e=b.props,d;for(d in e)!m.isEvProp(d)&&m.isFunc(e[d])&&("href"==d?(e.onclick=e[d],e.href=e[d].href):e[d]=e[d]()),m.isDynProp(b.tag,d)&&(e["."+d]=e[d]);if(m.isObj(e.style))for(var p in e.style)d=e.style[p],m.isFunc(d)&&(e.style[p]=d());m.isObj(e._hooks)&&(b.hooks=e._hooks,e._hooks=null);b.key=m.isVal(e._key)?e._key:m.isVal(e._ref)?e._ref:m.isVal(e.id)?e.id:m.isVal(e.name)?e.name:null;null!=e._ref&&(b.ref=e._ref);e._raw&&(b.raw=!0);null!=
e._data&&(b.data=e._data);e._diff&&(b.diff=e._diff);e._ref=e._key=e._raw=e._data=e._diff=null}}else m.isVal(e)?(b.type=m.TYPE_TEXT,b.body=e):m.isElem(e)&&(b.type=m.TYPE_ELEM,b.el=e,b.tag=e.nodeName.toLowerCase());null!==b.ref&&m.deepSet(c.refs,b.ref,b);b.parent=g;b.idx=l;b.ns=g&&g.ns?g.ns:"svg"===b.tag||"math"===b.tag?b.tag:null;a||b.diff||!m.isArr(b.body)||w(b,c);return b}function w(b,g){for(var l=0,c=b.body.length;l<c;l++){var a=b.body[l],e=null,h=null,p=!1,f=!1;m.isFunc(a)&&(a=a());if(null==a)p=
!0;else{var n=m.isArr(a),w=n?!1:m.isObj(a);if(n)a.length?"string"==typeof a[0]&&""!==a[0]?(h=d(a,b,l,g),e=h.key):m.isFunc(a[0])?e=x(a[1],a[2]):f=!0:p=!0;else if(w)if(m.isFunc(a.redraw))a.moveTo(b,l),h=a.node,e=a.view[1];else if(m.isElem(a))h=d(a,b,l,g);else{b.body[l--]=""+a;continue}else""===a?p=!0:0<l&&b.body[l-1].type===m.TYPE_TEXT?(b.body[l-1].body+=""+a,p=!0):h=d(""+a,b,l,g)}p||f?(f?m.insertArr(b.body,a,l,1):b.body.splice(l,1),c=b.body.length,l--):(null!==e&&(b.hasKeys=!0),b.body[l]=h||a)}b.body._init=
!0}function z(b,g){if(D(g,b))return g.moved=!0,g.wasSame=!0,g;g&&(f(b,"willRecycle",g,b),B(g,b),f(b,"didRecycle",g,b));if(m.isArr(b.body)){if(!b.body._init){for(var a=b;!a.vm;)a=a.parent;w(b,a.vm)}var c=0;b.body.forEach(function(a,e){var l=m.isArr(a);if(g){var h=C(a,b,g,c);if(null!==h){var d=h[0],h=h[1];d===c&&c++;d=g.body[d];d.vm?l?2===h?d.vm.moveTo(b,e,a[1]):1===h&&k(a[0],a[1],a[2],a[3],b,e):a.vm&&2===h&&a.vm===d.vm&&d.vm.moveTo(b,e):b.body[e]=z(a,d);return}}l?k(a[0],a[1],a[2],a[3],b,e):b.body[e]=
z(a)})}return b}function q(b,g,a,c){for(var d=!b.el;a&&a._node.removed;)a=a.nextSibling;d&&b.vm&&f(b.vm,"willMount",b.vm);if(b.type==m.TYPE_ELEM)if(d&&(b.el=g||(b.ns?L.createElementNS(F[b.ns],b.tag):L.createElement(b.tag)),b.props&&h(b)),m.isArr(b.body)){g=0;for(var e=b.el.firstChild;g<b.body.length;g++)e=q(b.body[g],null,e)}else m.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:d&&(b.el.textContent=b.body));else b.type==m.TYPE_TEXT&&d&&(b.el=L.createTextNode(b.body));b.el._node=b;g=b.parent;a!==b.el&&
(c||g&&g.el)&&(g=d?"Insert":"Reinsert",f(b,"will"+g,b),(c||b.parent.el).insertBefore(b.el,a),f(b,"did"+g,b));d&&b.vm&&b.vm.hooks&&!b.moved&&f(b.vm,"didMount",b.vm);return a!==b.el?a:a.nextSibling}function C(b,g,a,c,h){var e=m.isArr(b),d=e?x(b[1],b[2]):b.key,p=a.hasKeys,f=g.hasKeys;a=a.body;g=g.body;if(null!==d&&p)return b=m.keyedIdx(d,a,e?b[0]:null),-1<b?[b,2]:null;c=c||0;if(c>a.length-1)return null;h=0===h?0:h||a.length-1;for(d=null;c<=h;c++)if(p=a[c],null!==p&&p.el)if(e&&p.vm){if(p.vm.view[0]===
b[0]){if(p.vm.view[1]===x(b[1],b[2]))return[c,2];!d&&f&&-1==m.keyedIdx(p.key,g,p.vm.view[0])&&(d=[c,1])}}else if(b.type===p.type&&(b.type===m.TYPE_TEXT||null!==b.tag&&b.tag===p.tag)&&(null===p.key||!f||-1==m.keyedIdx(p.key,g,p.vm?p.vm.view[0]:null)))return[c,1];return d}function D(b,a){if(b&&b.diff&&a.diff&&b.diff[0]===a.diff[0]){var c=b.diff.slice(1).concat(a.diff.slice(1));return!a.diff[0].apply(null,c)}return!1}function B(b,a){if(b.el)if(a.el=b.el,b.el=null,a.el&&(a.el._node=a),a.type===m.TYPE_TEXT&&
a.body!==b.body)a.el.nodeValue=a.body;else{h(a,b);var c=!m.isArr(a.body),d=!m.isArr(b.body);c&&a.body!==b.body?d&&a.el.firstChild?a.el.firstChild.nodeValue=a.body:a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body:d&&!c&&(a.el.textContent="");b.moved=!0}}function p(b,a,c,d){return function(c){var e,h=c.target._node,l=null;if(m.isFunc(b))e=b.call(a,c,h,d);else if(m.isArr(b))l=b.slice(1),e=b[0].apply(a,l.concat(c,h,d));else if(m.isObj(b))for(var p in b){var f=b[p];null!=f&&"_"!=p[0]&&c.target.matches(p)&&
(m.isArr(f)?(l=f.slice(1),e=f[0].apply(a,l.concat(c,h,d))):m.isFunc(f)&&(e=f.call(a,c,h,d)))}!1===e&&(c.preventDefault(),c.stopPropagation());d.opts.hasOwnProperty("watch")&&d.opts.watch.fire({type:"event",vm:d,node:h,event:c,data:l})}}function h(b,a){var c=!a;a=a||{};if(a.props||b.props){var d=a.props||{},h=b.props||{},e=d.style,p=h.style;if(m.isObj(e)||m.isObj(p))N(b.el,b.tag,e||{},p||{},O,y,b.ns,c,b),d.style=h.style=null;N(b.el,b.tag,d,h,P,H,b.ns,c,b);p&&(h.style=p)}}function N(b,a,c,d,h,e,p,f,
n){for(var w in d)if(a=d[w],null!==a){var k="."===w[0]?b[w.substr(1)]:c[w];a===k||m.isArr(a)&&m.isArr(k)&&m.cmpArr(a,k)||h(b,w,a,p,f,n)}for(w in c)null!==c[w]&&null==d[w]&&e(b,w,p,f)}function O(b,a,c){b.style[a]=m.autoPx(a,c)}function y(b,a){b.style[a]=""}function P(b,a,c,d,h,e){if("."===a[0])a=a.substr(1),"svg"===d?b[a].baseVal=c:b[a]=c;else if("class"===a)b.className=c;else if("id"===a)b[a]=c;else if(m.isEvProp(a)){for(d=e;!d.vm;)d=d.parent;b[a]=p(c,d.vm.opts.evctx||d.vm.model||null,e,d.vm)}else!1===
c?H(b,a,d,h):b.setAttribute(a,!0===c?"":c)}function H(b,a,c,d){d||("."===a[0]?(a=a.substr(1),"svg"===c?b[a].baseVal=null:b[a]=null):"class"===a?b.className="":"id"===a||m.isEvProp(a)?b[a]=null:b.removeAttribute(a))}var F={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},L="undefined"==typeof document?{}:document,M={},K=[],J=[],I={debounce:!0,repaint:!0};v.view=k;v.view.config=function(b){for(var a in b)I[a]=b[a]};var G=null;v.view.extend=function(b,a){G=!G||a?[]:G;G.push(b)};
var m=v.utils;return v})(domvm);(function(v){var u=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,x=v.utils;v.html=function(k){var a="";switch(k.type){case x.TYPE_ELEM:a+="<"+k.tag;if(k.props){var f=x.isVal(k.props.style)?k.props.style:"",n=x.isObj(k.props.style)?k.props.style:null;if(n)for(var c in n)null!==n[c]&&(f+=x.camelDash(c)+": "+x.autoPx(c,n[c])+"; ");for(c in k.props)x.isEvProp(c)||"."===c[0]||(n=k.props[c],x.isFunc(n)&&(n=n()),x.isObj(n)||(!0===n?a+=" "+c:!1!==n&&null!==n&&
"."!==c[0]&&(a+=" "+c+'="'+n+'"')));f.length&&(a+=' style="'+f.trim()+'"')}if(k.ns&&"svg"!==k.tag&&"math"!==k.tag&&!k.body)return a+"/>";a+=">";break;case x.TYPE_TEXT:return k.body}u.test(k.tag)||(x.isArr(k.body)?k.body.forEach(function(c){a+=v.html(c)}):a+=k.body||"",a+="</"+k.tag+">");return a}})(domvm);(function(v){var u=v.utils;v.watch=function(x){function k(){}function a(a,d,f,k,q){q=q||{};q.method=a.toUpperCase();"credentials"in q||(q.credentials="same-origin");null!==f&&(u.isArr(f)||u.isObj(f)?(q.headers=q.headers||new Headers,q.headers.set("Content-Type","application/json"),q.body=JSON.stringify(f)):q.body=""+f);var C=k,D=function(a){return Promise.reject(a)};k instanceof Array&&(C=k[0],k[1]&&(D=k[1]));var B={type:"fetch",fetch:{method:a,url:d,body:f}};k=fetch(d,q).then(function(a){if(200<=
a.status&&300>a.status)return a;var c=Error(a.status+": "+a.statusText);c.data=a;return Promise.reject(c)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(C,D).then(function(a){!1!==a&&n.fire(B);return a},function(a){B.error=a;n.fire(B);return Promise.reject(a)});k._fetchArgs=[a,d,f,[C,D],q];return k}var f=[];u.isFunc(x)&&f.push(x);var n={on:function(a){f.push(a);return n},off:function(a){f.splice(f.indexOf(a),
1);return n},fire:u.raft(function(a){u.execAll(f,a);return n}),prop:function(c,d,f){var z=c,q=function(a,c,d){if(arguments.length&&a!==z){d=d||{type:"prop",prop:q,data:{old:z,"new":a}};f&&(a=f(d));if("undefined"==typeof a||a===z)return z;z=d.data["new"]=a;u.isFunc(c)?c(d):!1!==c&&n.fire(d)}return z};q._prop=!0;if(d&&d.then){q.update=k;if(d._fetchArgs){var C=d._fetchArgs[3];d._fetchArgs[3]=[function(a){return q(C[0]?C[0](a):a)},C[1]];q.update=function(){a.apply(null,d._fetchArgs)}}d.then(q)}return q.toString=
q},sync:function(a,d,f){var k=a,q=d;u.isFunc(k)||(k=function(d,f,k){if("string"==typeof a){var p,h;"e."==a.substr(0,2)?(p=d,h=a.substr(2)):(p=d.target,h=a)}return u.deepGet(p,h)});u.isArr(q)&&(q=function(a,c,f){var p=d[0],h=d[1];u.isFunc(h)&&(h=h(f.event,f.node,f.vm));var k=u.deepGet(p,h);a!==k&&(u.deepSet(p,h,a,c,f),u.isFunc(c)?c(f):!1!==c&&n.fire(f))});return function(a,c,d){var p={type:"sync",vm:d,node:c,event:a};q(k(a,c,d),f,p)}},fetch:a,get:function(c,d,f){f?c+=n.query(d):f=d;return a("get",
c,null,f)},"delete":function(c,d,f){f?c+=n.query(d):f=d;return a("delete",c,null,f)},post:function(c,d,f){return a("post",c,d,f)},put:function(c,d,f){return a("put",c,d,f)},patch:function(c,d,f){return a("patch",c,d,f)},query:function(a){if(!u.isObj(a))return"";var d=[],f=encodeURIComponent,k;for(k in a)d.push(f(k)+"="+f(a[k]));return d.length?"?"+d.join("&"):""}};return n}})(domvm);(function(v){function u(a,c,d,f,k,n){var p=null,h=null,u=null;if("/"==d[0]){u=d;h=!1;f={};n=u.split("#");c=n[0].split("?");p=c[0];n=n[1];c[1]&&(k={},c[1].split("&").map(function(a){a=a.split("=");k[a[0]]=null==a[1]?!0:a[1]}));var x,y;for(y in a){d=a[y];var v=d.path;if(x=p.match(d.regexPath)){h=y;-1!==v.indexOf(":")&&(f={},x.shift(),v.replace(/:([^\/]+)/g,function(a,c){f[c]=x.shift()}));break}}}else{h=d;d=a[h];var v=c+d.path,H=d.vars||{},u=-1!==v.indexOf(":")?p=v.replace(/:([^\/]+)/g,function(a,c){if((H[c]||
/^[^\/]+$/).test(f[c]))return f[c]+="";throw Error("Invalid value for route '"+v+"' segment '"+c+"': '"+f[c]+"'");}):p=v;if(k){var u=u+"?",F;for(F in k)u+=F+(!0!==k[F]?"="+k[F]:"")+"&";u=u.slice(0,-1)}u+=n?"#"+n:""}return{href:u,name:h,path:p,segs:f,hash:n,query:k}}function x(a,c){for(var d in a){var f=a[d];f.regexPath=new RegExp("^"+c+f.path.replace(/:([^\/]+)/g,function(a,c){var d=""+((f.vars||{})[c]||/[^\/]+/);return"("+d.substring(1,d.lastIndexOf("/"))+")"})+"$")}}var k=[],a=null,f=!1,n=null,
c=null,d="";v.route=function(w,v){function q(){var a=location,a=f?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return u(B,d,a)}var C=null,D={href:function(a,c,k,n,p){var q=u(B,d,a,c,k,n);return f?(a=function(a){D["goto"](q,null,null,null,p);a.preventDefault()},a.href=q.href,a):"#"+q.href},config:function(a){(f=a.useHist)&&(d=a.root||"");n=a.willEnter||null;c=a.willExit||null;C=a.init||null},refresh:function(){D["goto"](q(),null,null,null,!0)},"goto":function(h,q,v,y,x){h.href||(h=u(B,d,h,
q,v,y));if(!1===h.name)console.log("Could not find route");else{q=null;for(y=0;y<k.length;y++)if(k[y].href===h.href){q=y;break}null===q&&(k.splice(a+1,1E4),k.push(h),q=k.length-1);h=k[a];y=k[q];var w=!0;v=!0;null!==a&&(c&&(w=c(h,y)),!1!==w&&(w=(w=B[h.name].onexit)?w.apply(null,(h?[h.segs,h.query,h.hash]:[]).concat(y)):!0));!1!==w&&(n&&(v=n(y,h)),!1!==v&&(v=B[y.name].onenter.apply(null,(y?[y.segs,y.query,y.hash]:[]).concat(h))),!1!==v&&(f?(p=!0,history[x?"replaceState":"pushState"](null,"title",y.href)):
(y="#"+y.href,location.hash!==y&&(p=!0,x?location.replace(y):location.hash=y)),a=q))}},location:function(){return null==a?q():k[a]}},B=w(D,v);x(B,d);var p=!1;window.onhashchange=window.onpopstate=function(a){if(f||"popstate"!=a.type)!f&&p?p=!1:D["goto"](q(),null,null,null,!0)};C&&C();return D}})(domvm);
